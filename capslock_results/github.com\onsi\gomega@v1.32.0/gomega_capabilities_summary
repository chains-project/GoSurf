Capslock is an experimental tool for static analysis of Go packages.
Share feedback and file bugs at https://github.com/google/capslock.
To get machine-readable full analysis output, use -output=json

Analyzed packages:
  github.com/google/go-cmp v0.6.0
  golang.org/x/net v0.20.0
  golang.org/x/text v0.14.0
  google.golang.org/protobuf v1.33.0
  gopkg.in/yaml.v3 v3.0.1

CAPABILITY_FILES: 262 references (27 direct, 235 transitive)
Example callpath:
  github.com/onsi/gomega/matchers.normalise
  match_yaml_matcher.go:58:29:gopkg.in/yaml.v3.Marshal
  yaml.go:223:10:(*gopkg.in/yaml.v3.encoder).finish
  encode.go:72:8:(*gopkg.in/yaml.v3.encoder).emit
  encode.go:81:26:gopkg.in/yaml.v3.yaml_emitter_emit
  emitterc.go:153:33:gopkg.in/yaml.v3.yaml_emitter_state_machine
  emitterc.go:267:40:gopkg.in/yaml.v3.yaml_emitter_emit_document_end
  emitterc.go:523:24:gopkg.in/yaml.v3.yaml_emitter_flush
  writerc.go:44:74:(github.com/onsi/gomega/matchers.notARegularFileError).Error
  be_a_regular_file.go:19:21:(github.com/onsi/gomega/matchers.notARegularFileError).IsDir
  (*os.fileStat).IsDir

CAPABILITY_NETWORK: 241 references (78 direct, 163 transitive)
Example callpath:
  github.com/onsi/gomega/matchers.normalise
  match_yaml_matcher.go:58:29:gopkg.in/yaml.v3.Marshal
  yaml.go:223:10:(*gopkg.in/yaml.v3.encoder).finish
  encode.go:72:8:(*gopkg.in/yaml.v3.encoder).emit
  encode.go:81:26:gopkg.in/yaml.v3.yaml_emitter_emit
  emitterc.go:153:33:gopkg.in/yaml.v3.yaml_emitter_state_machine
  emitterc.go:267:40:gopkg.in/yaml.v3.yaml_emitter_emit_document_end
  emitterc.go:523:24:gopkg.in/yaml.v3.yaml_emitter_flush
  writerc.go:44:74:(*net/http.MaxBytesError).Error

CAPABILITY_READ_SYSTEM_STATE: 69 references (17 direct, 52 transitive)
Example callpath:
  github.com/onsi/gomega/ghttp.VerifyJSONRepresenting
  handlers.go:392:66:(github.com/onsi/gomega/ghttp.GHTTPWithGomega).VerifyJSONRepresenting
  handlers.go:166:32:(*github.com/onsi/gomega/internal.Assertion).ShouldNot
  assertion.go:56:76:(*github.com/onsi/gomega/internal.Assertion).match
  assertion.go:101:36:(*github.com/onsi/gomega/matchers.MatchJSONMatcher).FailureMessage
  match_json_matcher.go:34:56:(*github.com/onsi/gomega/matchers.MatchJSONMatcher).prettyPrint
  match_json_matcher.go:44:30:github.com/onsi/gomega/matchers.toString
  type_support.go:137:26:(*github.com/onsi/gomega/ghttp/protobuf.SimpleMessage).String
  simple_message.pb.go:43:36:(google.golang.org/protobuf/internal/impl.Export).MessageStringOf
  api_export.go:176:58:(google.golang.org/protobuf/encoding/prototext.MarshalOptions).Format
  encode.go:96:19:(google.golang.org/protobuf/encoding/prototext.MarshalOptions).Marshal
  encode.go:104:18:(google.golang.org/protobuf/encoding/prototext.MarshalOptions).marshal
  encode.go:138:26:(google.golang.org/protobuf/encoding/prototext.encoder).marshalMessage
  encode.go:159:29:(google.golang.org/protobuf/internal/impl.aberrantMessage).Descriptor
  legacy_message.go:510:30:google.golang.org/protobuf/internal/impl.LegacyLoadMessageDesc
  legacy_message.go:91:30:google.golang.org/protobuf/internal/impl.legacyLoadMessageDesc
  legacy_message.go:142:26:google.golang.org/protobuf/internal/impl.legacyLoadFileDesc
  legacy_file.go:62:9:(google.golang.org/protobuf/internal/filedesc.Builder).Build
  build.go:112:40:(*google.golang.org/protobuf/reflect/protoregistry.Files).RegisterFile
  registry.go:130:42:google.golang.org/protobuf/reflect/protoregistry.init$1
  registry.go:51:19:os.Getenv

CAPABILITY_OPERATING_SYSTEM: 10 references (10 direct, 0 transitive)
Example callpath:
  github.com/onsi/gomega/gexec.TerminateAndWait
  session.go:247:20:(*github.com/onsi/gomega/gexec.Session).Terminate
  session.go:178:17:(*github.com/onsi/gomega/gexec.Session).Signal
  session.go:190:27:(*os.Process).Signal

CAPABILITY_SYSTEM_CALLS: 2 references (2 direct, 0 transitive)
Example callpath:
  github.com/onsi/gomega/gexec.Start
  session.go:96:3:(*github.com/onsi/gomega/gexec.Session).monitorForExit
  session.go:202:39:(syscall.WaitStatus).Signal

CAPABILITY_UNANALYZED: 93 references (26 direct, 67 transitive)
Example callpath:
  github.com/onsi/gomega/ghttp.VerifyJSONRepresenting
  handlers.go:392:66:(github.com/onsi/gomega/ghttp.GHTTPWithGomega).VerifyJSONRepresenting
  handlers.go:166:32:(*github.com/onsi/gomega/internal.Assertion).ShouldNot
  assertion.go:56:76:(*github.com/onsi/gomega/internal.Assertion).match
  assertion.go:101:36:(*github.com/onsi/gomega/matchers.MatchJSONMatcher).FailureMessage
  match_json_matcher.go:34:56:(*github.com/onsi/gomega/matchers.MatchJSONMatcher).prettyPrint
  match_json_matcher.go:44:30:github.com/onsi/gomega/matchers.toString
  type_support.go:137:26:(*github.com/onsi/gomega/ghttp/protobuf.SimpleMessage).String
  simple_message.pb.go:43:36:(google.golang.org/protobuf/internal/impl.Export).MessageStringOf
  api_export.go:176:58:(google.golang.org/protobuf/encoding/prototext.MarshalOptions).Format
  encode.go:96:19:(google.golang.org/protobuf/encoding/prototext.MarshalOptions).Marshal
  encode.go:104:18:(google.golang.org/protobuf/encoding/prototext.MarshalOptions).marshal
  encode.go:138:26:(google.golang.org/protobuf/encoding/prototext.encoder).marshalMessage
  encode.go:179:19:google.golang.org/protobuf/internal/order.RangeFields
  range.go:40:27:(*sync.Pool).Get

CAPABILITY_UNSAFE_POINTER: 258 references (34 direct, 224 transitive)
Example callpath:
  github.com/onsi/gomega/gleak.IgnoreGinkgoParallelClient
  ginkgo_parallel_client.go:16:30:github.com/onsi/gomega/gleak.Goroutines
  goroutines.go:13:29:github.com/onsi/gomega/gleak/goroutine.Goroutines
  goroutine.go:94:19:github.com/onsi/gomega/gleak/goroutine.goroutines
  goroutine.go:108:19:github.com/onsi/gomega/gleak/goroutine.parseStack
  goroutine.go:126:55:github.com/onsi/gomega/gleak/goroutine.parseGoroutineBacktrace
  goroutine.go:202:24:(*bufio.Reader).Peek
  bufio.go:151:9:(*bufio.Reader).fill
  bufio.go:113:22:(*crypto/tls.Conn).Read
  conn.go:1373:42:(*crypto/tls.Conn).handlePostHandshakeMessage
  conn.go:1285:31:(*crypto/tls.Conn).handleRenegotiation
  conn.go:1275:39:(*crypto/tls.Conn).clientHandshake
  handshake_client.go:276:24:(*crypto/tls.clientHandshakeState).handshake
  handshake_client.go:495:31:(*crypto/tls.clientHandshakeState).doFullHandshake
  handshake_client.go:578:38:(*crypto/tls.Conn).verifyServerCertificate
  handshake_client.go:995:42:(*crypto/x509.Certificate).Verify
  verify.go:790:17:(*crypto/x509.Certificate).isValid
  verify.go:609:21:crypto/x509.forEachSAN
  parser.go:365:21:(*crypto/x509.Certificate).isValid$1
  verify.go:640:27:net/url.Parse
  url.go:476:26:(*net/url.URL).setFragment
  url.go:738:23:net/url.unescape
  url.go:254:8:(*strings.Builder).Grow
  builder.go:78:13:(*strings.Builder).copyCheck

CAPABILITY_REFLECT: 274 references (106 direct, 168 transitive)
Example callpath:
  github.com/onsi/gomega/matchers.toString
  type_support.go:137:26:(*github.com/onsi/gomega/ghttp/protobuf.SimpleMessage).String
  simple_message.pb.go:43:36:(google.golang.org/protobuf/internal/impl.Export).MessageStringOf
  api_export.go:176:58:(google.golang.org/protobuf/encoding/prototext.MarshalOptions).Format
  encode.go:96:19:(google.golang.org/protobuf/encoding/prototext.MarshalOptions).Marshal
  encode.go:104:18:(google.golang.org/protobuf/encoding/prototext.MarshalOptions).marshal
  encode.go:138:26:(google.golang.org/protobuf/encoding/prototext.encoder).marshalMessage
  encode.go:171:18:(google.golang.org/protobuf/encoding/prototext.encoder).marshalAny
  encode.go:351:13:(*google.golang.org/protobuf/internal/impl.MessageInfo).New
  message.go:226:18:reflect.New

CAPABILITY_EXEC: 15 references (15 direct, 0 transitive)
Example callpath:
  github.com/onsi/gomega/gexec.getForTest
  build.go:138:14:github.com/onsi/gomega/gexec.doGet
  build.go:145:23:os/exec.Command

