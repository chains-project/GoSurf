Capslock is an experimental tool for static analysis of Go packages.
Share feedback and file bugs at https://github.com/google/capslock.
To get machine-readable full analysis output, use -output=json

Analyzed packages:
  github.com/fsnotify/fsnotify v1.4.9
  github.com/go-task/slim-sprig v0.0.0-20210107165309-348f09dbbbc0
  github.com/nxadm/tail v1.4.8
  golang.org/x/sys v0.0.0-20210112080510-489259a85091
  golang.org/x/tools v0.0.0-20201224043029-2b0845dc783e
  gopkg.in/tomb.v1 v1.0.0-20141024135613-dd632973f1e7

CAPABILITY_FILES: 128 references (95 direct, 33 transitive)
Example callpath:
  (*github.com/onsi/ginkgo/ginkgo.SpecWatcher).WatchSuites$1
  watch_command.go:132:26:(*github.com/onsi/ginkgo/ginkgo/watch.DeltaTracker).WillRun
  delta_tracker.go:74:45:(*github.com/onsi/ginkgo/ginkgo/watch.Suite).MarkAsRunAndRecomputedDependencies
  suite.go:54:27:(*github.com/onsi/ginkgo/ginkgo/watch.PackageHashes).Add
  package_hashes.go:47:41:github.com/onsi/ginkgo/ginkgo/watch.NewPackageHash
  package_hash.go:30:59:(*github.com/onsi/ginkgo/ginkgo/watch.PackageHash).computeHashes
  package_hash.go:74:16:(*os.fileStat).IsDir

CAPABILITY_NETWORK: 122 references (80 direct, 42 transitive)
Example callpath:
  github.com/onsi/ginkgo/ginkgo/nodot.ApplyNoDot
  nodot.go:14:40:github.com/onsi/ginkgo/ginkgo/nodot.generateNodotSections
  nodot.go:111:56:github.com/onsi/ginkgo/ginkgo/nodot.getExportedDeclerationsForPackage
  nodot.go:146:26:go/build.Import
  build.go:1512:23:(*go/build.Context).Import
  build.go:877:30:(*go/build.Context).matchFile
  build.go:1478:34:go/build.readComments
  read.go:382:22:go/build.newImportReader
  read.go:42:12:(*bufio.Reader).Discard
  bufio.go:191:10:(*bufio.Reader).fill
  bufio.go:113:22:(*net/http.body).Read

CAPABILITY_READ_SYSTEM_STATE: 119 references (74 direct, 45 transitive)
Example callpath:
  (*github.com/onsi/ginkgo/internal/specrunner.SpecRunner).runSpecs
  spec_runner.go:176:32:(*github.com/onsi/ginkgo/internal/specrunner.SpecRunner).reportSpecDidComplete
  spec_runner.go:307:38:(*github.com/onsi/ginkgo/internal/remote.ForwardingReporter).SpecDidComplete
  forwarding_reporter.go:120:52:(*github.com/onsi/ginkgo/internal/remote.outputInterceptor).StartInterceptingOutput
  output_interceptor_unix.go:45:40:github.com/nxadm/tail.TailFile
  tail.go:150:2:(*github.com/nxadm/tail.Tail).tailFileSync
  tail.go:250:21:(*github.com/nxadm/tail.Tail).reopen
  tail.go:213:44:(*github.com/nxadm/tail/watch.InotifyFileWatcher).BlockUntilExists
  inotify.go:51:32:path/filepath.Abs
  path.go:294:12:path/filepath.abs
  path_unix.go:42:16:path/filepath.unixAbs
  path.go:301:21:os.Getwd

CAPABILITY_MODIFY_SYSTEM_STATE: 29 references (11 direct, 18 transitive)
Example callpath:
  github.com/onsi/ginkgo/ginkgo.main
  main.go:209:20:(*github.com/onsi/ginkgo/ginkgo.Command).Run
  main.go:165:11:github.com/onsi/ginkgo/ginkgo.convertPackage
  convert_command.go:50:24:github.com/onsi/ginkgo/ginkgo/convert.RewritePackage
  package_rewriter.go:24:45:github.com/onsi/ginkgo/ginkgo/convert.findTestsInPackage
  package_rewriter.go:65:26:github.com/onsi/ginkgo/ginkgo/convert.addGinkgoSuiteForPackage
  package_rewriter.go:86:16:os.Chdir

CAPABILITY_OPERATING_SYSTEM: 32 references (21 direct, 11 transitive)
Example callpath:
  (*github.com/onsi/ginkgo/ginkgo.SpecRunner).RunSpecs
  run_command.go:113:50:(*github.com/onsi/ginkgo/ginkgo.SuiteRunner).RunSuites
  suite_runner.go:119:43:(*github.com/onsi/ginkgo/ginkgo.SuiteRunner).compileInParallel
  suite_runner.go:67:3:(*github.com/onsi/ginkgo/ginkgo.SuiteRunner).compileInParallel$1
  suite_runner.go:75:17:(*github.com/onsi/ginkgo/ginkgo.SpecWatcher).WatchSuites$1
  watch_command.go:132:26:(*github.com/onsi/ginkgo/ginkgo/watch.DeltaTracker).WillRun
  delta_tracker.go:74:45:(*github.com/onsi/ginkgo/ginkgo/watch.Suite).MarkAsRunAndRecomputedDependencies
  suite.go:49:30:github.com/onsi/ginkgo/ginkgo/watch.NewDependencies
  dependencies.go:24:39:(github.com/onsi/ginkgo/ginkgo/watch.Dependencies).seedWithDepsForPackageAtPath
  dependencies.go:50:17:(github.com/onsi/ginkgo/ginkgo/watch.Dependencies).resolveAndAdd
  dependencies.go:77:27:go/build.Import
  build.go:1512:23:(*go/build.Context).Import
  build.go:864:13:(*os.unixDirent).IsDir

CAPABILITY_SYSTEM_CALLS: 34 references (1 direct, 33 transitive)
Example callpath:
  (*github.com/onsi/ginkgo/internal/specrunner.SpecRunner).reportSuiteDidEnd
  spec_runner.go:321:27:(*github.com/onsi/ginkgo/internal/remote.ForwardingReporter).SpecSuiteDidEnd
  forwarding_reporter.go:141:60:(*github.com/onsi/ginkgo/internal/remote.outputInterceptor).StopInterceptingAndReturnOutput
  output_interceptor_unix.go:72:29:(*github.com/nxadm/tail.Tail).Cleanup
  tail.go:454:15:github.com/nxadm/tail/watch.Cleanup
  inotify_tracker.go:130:20:github.com/nxadm/tail/watch.RemoveWatch
  inotify_tracker.go:88:15:github.com/nxadm/tail/watch.remove
  github.com/nxadm/tail/watch.init$1
  inotify_tracker.go:55:3:(*github.com/nxadm/tail/watch.InotifyTracker).run
  inotify_tracker.go:218:37:github.com/fsnotify/fsnotify.NewWatcher
  inotify.go:45:13:golang.org/x/sys/unix.Close

CAPABILITY_UNANALYZED: 198 references (87 direct, 111 transitive)
Example callpath:
  github.com/onsi/ginkgo/ginkgo.goFmt
  main.go:302:18:github.com/onsi/ginkgo/ginkgo.complainAndQuit
  main.go:248:21:github.com/onsi/ginkgo/ginkgo.emitRCAdvertisement
  main.go:326:20:github.com/onsi/ginkgo/formatter.F
  formatter.go:22:29:(github.com/onsi/ginkgo/formatter.Formatter).F
  formatter.go:78:13:(github.com/onsi/ginkgo/formatter.Formatter).Fi
  formatter.go:82:14:(github.com/onsi/ginkgo/formatter.Formatter).Fiw
  formatter.go:86:28:(github.com/onsi/ginkgo/formatter.Formatter).style
  formatter.go:177:36:(*regexp.Regexp).ReplaceAllString
  regexp.go:583:20:(*regexp.Regexp).replaceAll
  regexp.go:625:20:(*regexp.Regexp).doExecute
  exec.go:535:22:(*regexp.Regexp).backtrack
  backtrack.go:357:21:(*regexp.inputReader).step
  regexp.go:492:27:(*bufio.Reader).ReadRune

CAPABILITY_UNSAFE_POINTER: 200 references (74 direct, 126 transitive)
Example callpath:
  (*github.com/onsi/ginkgo/internal/spec.Spec).Run
  spec.go:138:17:(*github.com/onsi/ginkgo/internal/spec.Spec).runSample
  spec.go:215:26:(*github.com/onsi/ginkgo/internal/leafnodes.ItNode).Run
  it_node.go:26:24:(*github.com/onsi/ginkgo/internal/leafnodes.runner).run
  runner.go:64:19:(*github.com/onsi/ginkgo/internal/leafnodes.runner).runSync
  runner.go:105:2:(*github.com/onsi/ginkgo/internal/leafnodes.runner).runSync$1
  runner.go:107:35:github.com/onsi/ginkgo/internal/codelocation.New
  code_location.go:14:26:github.com/onsi/ginkgo/internal/codelocation.PruneStack
  code_location.go:39:26:regexp.MustCompile
  regexp.go:317:24:regexp.Compile
  regexp.go:137:16:regexp.compile
  regexp.go:205:73:regexp.onePassPrefix
  onepass.go:60:16:(*strings.Builder).WriteRune
  builder.go:106:13:(*strings.Builder).copyCheck

CAPABILITY_REFLECT: 96 references (61 direct, 35 transitive)
Example callpath:
  (*github.com/onsi/ginkgo/internal/specrunner.SpecRunner).reportSpecWillRun
  spec_runner.go:298:23:(*github.com/onsi/ginkgo/internal/remote.ForwardingReporter).SpecWillRun
  forwarding_reporter.go:115:15:(*github.com/onsi/ginkgo/internal/remote.ForwardingReporter).post
  forwarding_reporter.go:77:28:encoding/json.Marshal
  encode.go:162:18:(*encoding/json.encodeState).marshal
  encode.go:295:16:(*encoding/json.encodeState).reflectValue
  encode.go:323:17:(encoding/json.floatEncoder).encode$bound
  (encoding/json.floatEncoder).encode

CAPABILITY_EXEC: 63 references (45 direct, 18 transitive)
Example callpath:
  (*github.com/onsi/ginkgo/ginkgo.SpecWatcher).WatchSuites$1
  watch_command.go:132:26:(*github.com/onsi/ginkgo/ginkgo/watch.DeltaTracker).WillRun
  delta_tracker.go:74:45:(*github.com/onsi/ginkgo/ginkgo/watch.Suite).MarkAsRunAndRecomputedDependencies
  suite.go:49:30:github.com/onsi/ginkgo/ginkgo/watch.NewDependencies
  dependencies.go:24:39:(github.com/onsi/ginkgo/ginkgo/watch.Dependencies).seedWithDepsForPackageAtPath
  dependencies.go:50:17:(github.com/onsi/ginkgo/ginkgo/watch.Dependencies).resolveAndAdd
  dependencies.go:77:27:go/build.Import
  build.go:1512:23:(*go/build.Context).Import
  build.go:648:26:(*go/build.Context).importGo
  build.go:1211:21:os/exec.Command

